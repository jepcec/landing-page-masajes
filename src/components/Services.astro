---
// Services Data with images
// Nota: Se eliminó la propiedad 'time' de los objetos
const services = [
  {
    id: "inka-massage",
    title: "The Inka Massage",
    price: "S/ 150",
    image: "https://images.unsplash.com/photo-1639162906614-0603b0ae95fd?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
    shortDesc: "Ancient Andean techniques combining soft and strong massage on energy points.",
    fullDesc: "This massage offers a combination of softer and stronger massage that relieves muscle tension by focusing on energetic trigger points. The massage relaxes muscles and reduces muscle pain, providing a unique Andean healing experience.",
    variations: ["Aromatherapy Add-on", "Deep Tissue Focus", "Herbal Compress"],
    tag: "Signature"
  },
  {
    id: "champi-massage",
    title: "Champi Massage",
    price: "S/ 50",
    image: "https://mailuna.net/wp-content/uploads/2016/12/champi.jpg",
    shortDesc: "Indian head therapy to relieve mental fatigue and restore balance.",
    fullDesc: "Indian Massage is a safe and effective massage that relieves back, neck and head. The work done with the Champi massage is on the energy points, promotes physical harmony and balance, mental and emotional well-being.",
    variations: ["Scalp Oil Treatment", "Neck & Shoulder Focus"],
    tag: "Relaxing"
  },
  {
    id: "swedish-massage",
    title: "Swedish Massage",
    price: "S/ 120",
    image: "https://images.unsplash.com/photo-1519823551278-64ac92734fb1?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
    shortDesc: "Classic soothing massage to improve circulation and reduce stress.",
    fullDesc: "Swedish Massage is a soothing massage and deep kneading. Regulates blood circulation and relieves muscle pain, stress and general health. It is designed to treat body and soul.",
    variations: ["Soft Pressure", "Medium Pressure", "Full Body Integration"],
    tag: "Popular"
  },
  {
    id: "shiatsu-massage",
    title: "Shiatsu Massage",
    price: "S/ 100",
    image: "https://www.royaltreatmenttherapeutics.com/wp-content/uploads/2018/07/02I20611.jpg",
    shortDesc: "Japanese technique using pressure points to improve vitality.",
    fullDesc: "Japanese Technique: Regulates the flow of energy in the body, relaxes the joints and improves vitality. The Shiatsu massage techniques accumulated using pressure applied with hands, thumbs, elbows and knees.",
    variations: ["Mat Stretching", "Energy Balancing", "Sports Recovery"],
    tag: "Therapeutic"
  },
  {
    id: "hot-stones",
    title: "Rumu Inkas Massage",
    price: "S/ 250",
    image: "https://images.unsplash.com/photo-1610402601271-5b4bd5b3eba4?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
    shortDesc: "Full body therapy with hot stones to relax muscles and balance energy.",
    fullDesc: "Full Body therapy and massage with hot stones will aid to relax your muscles and eliminate muscular pain and discomfort. Stones boost the energy flux, balancing the physical, mental, emotional and spiritual.",
    variations: ["Volcanic Stones", "Chakra Alignment", "Aromatherapy Add-on"],
    tag: "Luxury"
  },
  {
    id: "lomi-lomi",
    title: "Lomi Lomi Miu",
    price: "S/ 80",
    image: "https://masajescostarican.com/wp-content/uploads/2013/06/Masaje-de-cuello.jpg",
    shortDesc: "Hawaiian healing massage combining breath, energy and flowing touch.",
    fullDesc: "Can not be compared with other massages. It is a mixture of player's breath and energy with a selection of touch massage to break bottlenecks in the body. A truly unique and transformative experience.",
    variations: ["Traditional Style", "Deep Tissue Blend", "Relaxation Focus"],
    tag: "Holistic"
  },
  {
    id: "feet-reflexology",
    title: "Reflexology & Foot Massage",
    price: "S/ 80",
    image: "https://bellasante.com/cdn/shop/articles/spa_reflexology_284dbd02-7e64-4284-b89f-9c0b2d7bc735.jpg?v=1758840188",
    shortDesc: "Stimulate the nervous system through pressure points on the feet.",
    fullDesc: "Massage performed on the feet, where it is reflected throughout our bodies. It relaxes, stimulates the nervous system and improves conditions, alleviate its symptoms, restoring vitality and the capacity for self-healing.",
    variations: ["Exfoliating Scrub", "Hydrating Mask", "Leg Massage Extension"],
    tag: "Recovery"
  },
  {
    id: "cupping-massage",
    title: "Cupping Massage",
    price: "S/ 110",
    image: "https://media.post.rvohealth.io/wp-content/uploads/2019/01/Female_Cupping_Therapy_732x549-thumbnail.jpg",
    shortDesc: "Ancient suction therapy to increase blood flow and reduce pain.",
    fullDesc: "Cupping is an ancient therapy that is now back in style. It aims to increase blood flow, soften scar tissue, and decrease muscle pain by placing cups on the skin to create suction. Excellent for chronic pain.",
    variations: ["Static Cupping", "Sliding Cupping", "Combined with Deep Tissue"],
    tag: "Upgrade"
  },
  {
    id: "facial",
    title: "Facial Treatment",
    price: "S/ 50",
    image: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQTxL02ShD4rg-yP4K80w13Ll66HGn61_tQFA&s",
    shortDesc: "Rejuvenating facial care for glowing, healthy skin.",
    fullDesc: "Our facial treatment cleanses, exfoliates, and nourishes the skin, promoting a clear, well-hydrated complexion. Customized to your skin type for optimal results and relaxation.",
    variations: ["Deep Cleansing", "Hydrating Mask", "Anti-Aging Treatment"],
    tag: "Beauty"
  },
  {
    id: "manicure",
    title: "Manicure",
    price: "S/ 40",
    image: "https://static.wixstatic.com/media/28d39c_39fee459703c4ddcb33b511055322794~mv2.jpg/v1/fill/w_1000,h_750,al_c,q_85,usm_0.66_1.00_0.01/28d39c_39fee459703c4ddcb33b511055322794~mv2.jpg",
    shortDesc: "Professional nail care for beautiful, healthy hands.",
    fullDesc: "Complete hand and nail care including shaping, cuticle treatment, hand massage, and polish application. Leave with perfectly groomed nails and soft, moisturized hands.",
    variations: ["Classic Polish", "Gel Polish", "Natural Buff"],
    tag: "Beauty"
  },
  {
    id: "pedicure",
    title: "Pedicure",
    price: "S/ 50",
    image: "https://plus.unsplash.com/premium_photo-1661499249417-c20d6b668469?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
    shortDesc: "Complete foot care for smooth, beautiful feet.",
    fullDesc: "Indulge in our relaxing pedicure that includes foot soak, exfoliation, callus removal, nail shaping, cuticle care, massage, and polish. Your feet will thank you.",
    variations: ["Classic Polish", "Gel Polish", "Spa Pedicure"],
    tag: "Beauty"
  },
  {
    id: "waxing",
    title: "Waxing",
    price: "S/ 60",
    image: "https://royaltywellnessspa.com/storage/2024/06/Waxing-by-Royalty-Wellness-Spa-in-Memphis-TN.webp",
    shortDesc: "Professional hair removal for smooth, lasting results.",
    fullDesc: "Our professional waxing services provide smooth, long-lasting hair removal. We use high-quality wax suitable for sensitive skin, ensuring minimal discomfort and maximum results.",
    variations: ["Full Leg", "Half Leg", "Arms", "Underarms", "Bikini"],
    tag: "Beauty"
  },
];

// Tag colors mapping
const tagColors: Record<string, { bg: string; text: string }> = {
  "Signature": { bg: "bg-amber-100", text: "text-amber-700" },
  "Relaxing": { bg: "bg-blue-100", text: "text-blue-700" },
  "Popular": { bg: "bg-rose-100", text: "text-rose-700" },
  "Therapeutic": { bg: "bg-purple-100", text: "text-purple-700" },
  "Luxury": { bg: "bg-yellow-100", text: "text-yellow-700" },
  "Recovery": { bg: "bg-green-100", text: "text-green-700" },
  "Upgrade": { bg: "bg-teal-100", text: "text-teal-700" },
  "Holistic": { bg: "bg-indigo-100", text: "text-indigo-700" },
  "Beauty": { bg: "bg-pink-100", text: "text-pink-700" },
};
---

<section id="services" class="py-20 lg:py-28 bg-gradient-to-b from-stone-50 to-white">
  <div class="container mx-auto px-6">
    <div class="text-center mb-16">
      <span class="inline-block text-teal-600 font-semibold text-sm uppercase tracking-widest mb-4">What We Offer</span>
      <h2 class="text-4xl lg:text-5xl font-bold text-stone-800 mb-6">Our Treatments</h2>
      <p class="text-stone-500 max-w-2xl mx-auto text-lg leading-relaxed">
        Discover a sanctuary of peace. Each treatment is designed to restore balance, 
        relieve tension, and rejuvenate your body and mind.
      </p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {services.map((s) => (
        <>
          {/* Service Card */}
          <div class="group bg-white rounded-3xl shadow-sm hover:shadow-xl transition-all duration-500 border border-stone-100 flex flex-col h-full overflow-hidden">
             
            {/* Image Container - Fixed aspect ratio */}
            <div class="relative aspect-[4/3] overflow-hidden">
              <img 
                src={s.image} 
                alt={s.title}
                class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"
                loading="lazy"
              />
              {/* Overlay gradient */}
              <div class="absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"></div>
              
              {/* Tag badge */}
              <div class="absolute top-4 left-4">
                <span class={`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wide ${tagColors[s.tag]?.bg || 'bg-teal-100'} ${tagColors[s.tag]?.text || 'text-teal-700'} backdrop-blur-sm`}>
                  {s.tag}
                </span>
              </div>

              {/* Quick view button on hover */}
              <button 
                data-open-modal={s.id}
                class="absolute bottom-4 left-1/2 -translate-x-1/2 translate-y-4 opacity-0 group-hover:translate-y-0 group-hover:opacity-100 transition-all duration-500 bg-white text-stone-800 px-6 py-2.5 rounded-full font-semibold text-sm shadow-lg hover:bg-teal-600 hover:text-white cursor-pointer"
              >
                Quick View
              </button>
            </div>

            {/* Content */}
            <div class="p-6 flex flex-col flex-grow">
              <h3 class="text-xl font-bold text-stone-800 group-hover:text-teal-700 transition-colors mb-3">
                {s.title}
              </h3>
              
              <p class="text-stone-500 text-sm leading-relaxed flex-grow mb-5">
                {s.shortDesc}
              </p>

              {/* Footer */}
              <div class="flex items-center justify-between pt-5 border-t border-stone-100">
                <div class="flex flex-col">
                  <span class="text-xs text-stone-400 uppercase tracking-wide">From</span>
                  <span class="text-2xl font-bold text-teal-700">{s.price}</span>
                </div>
                
                <button 
                  data-open-modal={s.id}
                  class="flex items-center gap-2 text-sm font-semibold text-teal-600 hover:text-teal-800 transition-colors cursor-pointer group/btn"
                >
                  Details 
                  <span class="w-6 h-6 rounded-full bg-teal-50 flex items-center justify-center group-hover/btn:bg-teal-100 group-hover/btn:translate-x-1 transition-all">
                    <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                  </span>
                </button>
              </div>
            </div>
          </div>

          {/* Modal */}
          <dialog 
            id={s.id} 
            class="backdrop:bg-stone-900/70 backdrop:backdrop-blur-sm bg-transparent p-0 m-auto rounded-3xl shadow-2xl w-[calc(100%-2rem)] md:max-w-2xl max-h-[90vh] overflow-hidden"
          >
            <div class="bg-white rounded-3xl relative overflow-hidden">
              {/* Modal Image */}
              <div class="relative aspect-[16/9] overflow-hidden">
                <img 
                  src={s.image} 
                  alt={s.title}
                  class="w-full h-full object-cover"
                />
                <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"></div>
                
                {/* Close button */}
                <button 
                  data-close-modal={s.id} 
                  class="absolute top-4 right-4 text-white/80 hover:text-white bg-black/20 hover:bg-black/40 rounded-full p-2 transition-all backdrop-blur-sm cursor-pointer"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>

                {/* Title overlay on image */}
                <div class="absolute bottom-0 left-0 right-0 p-6 md:p-8">
                  <span class={`inline-flex items-center px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide ${tagColors[s.tag]?.bg || 'bg-teal-100'} ${tagColors[s.tag]?.text || 'text-teal-700'} mb-3`}>
                    {s.tag}
                  </span>
                  <h3 class="text-2xl md:text-3xl font-bold text-white">{s.title}</h3>
                </div>
              </div>

              {/* Modal Content */}
              <div class="p-6 md:p-8 overflow-y-auto max-h-[50vh]">
                {/* Meta info (Sin Duración) */}
                <div class="flex flex-wrap gap-4 mb-6">
                  <span class="flex items-center gap-2 bg-teal-50 px-4 py-2 rounded-xl text-sm text-teal-700">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span class="font-bold text-lg">{s.price}</span>
                  </span>
                </div>

                {/* Description */}
                <div class="mb-8">
                  <h4 class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-3">About This Treatment</h4>
                  <p class="text-stone-600 leading-relaxed">{s.fullDesc}</p>
                </div>

                {/* Variations */}
                <div class="bg-gradient-to-br from-teal-50 to-emerald-50 rounded-2xl p-5 mb-8 border border-teal-100/50">
                  <h4 class="text-xs font-bold text-teal-700 uppercase tracking-widest mb-4">Available Options</h4>
                  <ul class="space-y-2.5">
                    {s.variations.map(v => (
                      <li class="flex items-center gap-3 text-stone-700">
                        <span class="w-6 h-6 rounded-full bg-teal-500 flex items-center justify-center flex-shrink-0">
                          <svg class="w-3.5 h-3.5 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                          </svg>
                        </span>
                        <span class="font-medium">{v}</span>
                      </li>
                    ))}
                  </ul>
                </div>

                {/* CTA Button - WHATSAPP INTEGRADO */}
                <a 
                  href={`https://wa.me/51949570782?text=${encodeURIComponent(
                    `Hola! Me gustaría reservar una cita.\n\n` +
                    `Tratamiento: *${s.title}*\n` +
                    `Precio: *${s.price}*\n\n` +
                    `Quedo atento a su confirmación.`
                  )}`}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="w-full bg-gradient-to-r from-teal-600 to-emerald-600 text-white font-bold py-4 rounded-2xl hover:from-teal-700 hover:to-emerald-700 transition-all shadow-lg shadow-teal-600/20 active:scale-[0.98] transform duration-100 flex items-center justify-center gap-2 decoration-0"
                >
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                  </svg>
                  Book This Treatment
                </a>
              </div>
            </div>
          </dialog>
        </>
      ))}
    </div>

  </div>
</section>

<script>
  // Modal functionality
  const openButtons = document.querySelectorAll('[data-open-modal]');
  const closeButtons = document.querySelectorAll('[data-close-modal]');

  openButtons.forEach(button => {
    button.addEventListener('click', () => {
      const modalId = button.getAttribute('data-open-modal');
      const modal = document.getElementById(modalId || "") as HTMLDialogElement;
      if (modal) {
        modal.showModal();
        document.body.style.overflow = 'hidden';
      }
    });
  });

  const closeModal = (modal: HTMLDialogElement) => {
    modal.close();
    document.body.style.overflow = '';
  }

  closeButtons.forEach(button => {
    button.addEventListener('click', () => {
      const modalId = button.getAttribute('data-close-modal');
      const modal = document.getElementById(modalId || "") as HTMLDialogElement;
      if (modal) closeModal(modal);
    });
  });

  // Close on backdrop click
  const dialogs = document.querySelectorAll('dialog');
  dialogs.forEach(dialog => {
    dialog.addEventListener('click', (e) => {
      const rect = dialog.getBoundingClientRect();
      if (
        e.clientX < rect.left ||
        e.clientX > rect.right ||
        e.clientY < rect.top ||
        e.clientY > rect.bottom
      ) {
        closeModal(dialog as HTMLDialogElement);
      }
    });
  });

  // Close on Escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      dialogs.forEach(dialog => {
        if (dialog.hasAttribute('open')) {
          closeModal(dialog as HTMLDialogElement);
        }
      });
    }
  });
</script>

<style>
  /* Modal animation */
  dialog[open] {
    animation: modalIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  @keyframes modalIn {
    from { 
      opacity: 0; 
      transform: scale(0.9) translateY(20px); 
    }
    to { 
      opacity: 1; 
      transform: scale(1) translateY(0); 
    }
  }

  /* Custom scrollbar */
  dialog::-webkit-scrollbar {
    width: 6px;
  }

  dialog::-webkit-scrollbar-track {
    background: transparent;
  }

  dialog::-webkit-scrollbar-thumb {
    background-color: rgba(0, 0, 0, 0.1);
    border-radius: 20px;
  }

  /* Smooth image loading */
  img {
    transition: opacity 0.3s ease;
  }
</style>
